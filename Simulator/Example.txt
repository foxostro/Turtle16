# let kSerialInterface = 6
# let kIORegister = 0
# let kStatusRegister = 1

LI D, 6 # kSerialInterface
LI P, 'H'
LI P, 'e'
LI P, 'l'
LI P, 'l'
LI P, 'o'
LI P, ','
LI P, ' '
LI P, 'W'
LI P, 'o'
LI P, 'r'
LI P, 'l'
LI P, 'd'
LI P, '!'
LI P, 10

beginningOfInputLoop:

LXY waitForInput
JALR
NOP
NOP

# Read a byte and echo it back.
LI D, 6 # kSerialInterface
LI Y, 0 # kIORegister
MOV A, P
MOV P, A

LXY beginningOfInputLoop
JMP
NOP
NOP
HLT




waitForInput:

# Wait until the number of available bytes is greater than zero.
loop:
LI D, 6 # kSerialInterface
LI Y, 1 # kStatusRegister
MOV B, P
LI A, 1
CMP
LXY loop
JC
NOP
NOP

# Return from the function.
MOV X, G
MOV Y, H
JMP
NOP
NOP
